---
title: "Where Are Bees Headed?"
author: "Tate Reynolds and Thatcher Geary"
date: "4/19/2022"
output: ioslides_presentation
---

```{r data setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyUSDA)
library(tmap)
library(usmap)
library(ggplot2)
library(dplyr)
library(plyr)
library(tidyverse)
library(plotly)
key <- 'B7A59EDE-41E6-31AC-8492-E88C629693FA'
tidyUSDA::allProgram %>% head()

#Honey Production Data
honey.prod.2021 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2021'
)

honey.prod.2019 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2019'
)

honey.prod.2012 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2012'
)

honey.prod.2010 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2010'
)

honey.prod.2008 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2008'
)

honey.prod.2006 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2006'
)

honey.prod.2004 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2004'
)

honey.prod.2002 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2002'
)

honey.prod.2000 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '2000'
)

honey.prod.1998 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'NATIONAL',
  year = '1998'
)


#By state for box plots

state.honey.prod.geomF.2020 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2020',
  state = NULL
)

state.honey.prod.geomF.2018 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2018',
  state = NULL
)

state.honey.prod.geomF.2016 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2016',
  state = NULL
)

state.honey.prod.geomF.2014 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2014',
  state = NULL
)

state.honey.prod.geomF.2012 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2012',
  state = NULL
)

state.honey.prod.geomF.2010 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2010',
  state = NULL
)

state.honey.prod.geomF.2008 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2008',
  state = NULL
)

state.honey.prod.geomF.2006 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2006',
  state = NULL
)

state.honey.prod.geomF.2004 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2004',
  state = NULL
)

state.honey.prod.geomF.2002 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2002',
  state = NULL
)

state.honey.prod.geomF.2000 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2000',
  state = NULL
)

state.honey.prod.geomF.1998 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '1998',
  state = NULL
)

#For Maps
state.honey.prod.2020 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2020',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2018 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2018',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2016 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2016',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2014 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2014',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2012 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2012',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2010 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2010',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2008 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2008',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2006 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2006',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2004 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2004',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2002 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2002',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.2000 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '2000',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

state.honey.prod.1998 <- tidyUSDA::getQuickstat(
  sector='ANIMALS & PRODUCTS',
  group=NULL,
  commodity='HONEY',
  category=NULL,
  domain='TOTAL',
  county=NULL,
  key = key,
  program = 'SURVEY',
  data_item = 'HONEY - PRODUCTION, MEASURED IN LB',
  geographic_level = 'STATE',
  year = '1998',
  state = NULL,
  geometry = TRUE,
  lower48 = FALSE, 
  weighted_by_area = T
)

#Example of mapping data
#ggplot(data = state.honey.prod.1998, aes(fill = Value)) +
 # geom_sf()


#Manipulating data
state.df.list <- list(state.honey.prod.geomF.1998, 
                      state.honey.prod.geomF.2000, 
                      state.honey.prod.geomF.2002, 
                      state.honey.prod.geomF.2004, 
                      state.honey.prod.geomF.2006, 
                      state.honey.prod.geomF.2008, 
                      state.honey.prod.geomF.2010, 
                      state.honey.prod.geomF.2012, 
                      state.honey.prod.geomF.2014, 
                      state.honey.prod.geomF.2016, 
                      state.honey.prod.geomF.2018,
                      state.honey.prod.geomF.2020)

all.state.data <- Reduce(function(...) merge(...,all=T), state.df.list)


```


## R Markdown

```{r}
boxplot(Value ~ year, data = all.state.data, 
        main="Stats for Honey Production, 1998-2020", 
        xlab="States", ylab="Value", 
        col=rainbow(length(2020:1998)))

plot(Value ~ year, data = all.state.data, 
        main="Stats for Honey Production, 1998-2020", 
        xlab="States", ylab="Value", 
        col=rainbow(length(2020:1998)))

scatter.plot.states <- ggplot(data = all.state.data, aes(x=year, y=Value, color=state_name)) +
  geom_point() + 
  geom_smooth()

ggplotly(scatter.plot.states)
```
This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets
```{r}

plot(Value ~ year, data = all.state.data, 
        main="Stats for Honey Production, 1998-2020", 
        xlab="States", ylab="Value", 
        col=rainbow(length(2020:1998)))


```
- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r scatter, warning=FALSE,message=FALSE}
scatter.plot.states <- ggplot(data = all.state.data, aes(x=year, y=Value, color=state_name)) +
  geom_point() + 
  geom_smooth()

ggplotly(scatter.plot.states)
```

## Slide with Plot

```{r t.test}
national.honey.prod.list.98.06 <- list(honey.prod.1998, honey.prod.2000, honey.prod.2002, honey.prod.2004, honey.prod.2006)
national.honey.prod.list.08.21 <- list(honey.prod.2008, honey.prod.2010, honey.prod.2012, honey.prod.2019, honey.prod.2021)
data.98.06 <- Reduce(function(...) merge(...,all=T), national.honey.prod.list.98.06)
data.08.21 <- Reduce(function(...) merge(...,all=T), national.honey.prod.list.08.21)
t.test(data.98.06$Value, data.08.21$Value, conf.level = 0.95)
```

